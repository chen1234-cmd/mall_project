<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>首页</title>
    <meta name="keywords" content="">
    <meta name="description" content="">
    <script src="js/rem.js"></script>    
    <link href="iconfont/iconfont.css" rel="stylesheet">
    <link href="css/mui.min.css" rel="stylesheet">
    <link href="css/all.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="css/base.css"/>
    <link rel="stylesheet" type="text/css" href="css/style.css"/>
	<script src="js/public.js" type="text/javascript" charset="utf-8"></script>
</head>
<style type="text/css">
	a.tag{
		color: #8F8F94;
	}
</style>
<body>
    <header class="mui-bar mui-bar-nav" id="header">
        <div class="top-sch-box flex-col">
            <div class="centerflex">
                <i class="fdj iconfont icon-search"></i>
                <div class="sch-txt">约会要穿仙女裙</div>
                <span class="shaomiao"><i class="iconfont icon-saoma"></i></span>
            </div>
        </div>
        <a class="btn" href="javascript:;">
            <i class="iconfont icon-tixing"></i>
        </a>
        <a class="btn" href="shopcar.html">
            <i class="iconfont icon-cart"></i>
        </a>
    </header>

<div id="main" class="mui-clearfix">
	 <!-- 搜索层 -->
    <div class="pop-schwrap">
        <div class="ui-scrollview">
            <div class="mui-bar mui-bar-nav clone">
                <a class="btn btn-back" href="javascript:;"></a>
                <div class="top-sch-box flex-col">
                    <div class="centerflex">
                        <input class="sch-input mui-input-clear" type="text" name="sq" id="sq" placeholder="约会要穿仙女裙" />
                    </div>
                </div>
                <a class="mui-btn mui-btn-primary sch-submit" id="search" >搜索</a>
            </div>
            <div class="scroll-wrap">
                <div class="mui-scroll">
                    <div class="sch-cont">
                       <!-- <div class="section ui-border-b">
                            <div class="tit"><i class="iconfont icon-hot"></i>热门搜索</div>
                            <div class="tags">
                                <span class="tag">外套</span><span class="tag">连衣裙</span><span class="tag">运动鞋</span><span class="tag">睡衣</span>
                                <span class="tag actice">外套</span><span class="tag">连衣裙</span><span class="tag">运动鞋</span><span class="tag">睡衣</span>
                                <span class="tag">外套</span><span class="tag actice">连衣裙</span><span class="tag">运动鞋</span>
                            </div>
                        </div> -->
                        <div class="section">
                            <div class="tit"><i class="iconfont icon-time"></i>最近搜索</div>
                            <div class="tags" id="tags2">
								
                            </div>
                        </div>
                    </div>
                    <div class="sch-clear">
                        <a href="javascript:;" id="clearsq"><i class="iconfont icon-shanchu"></i>清除搜索历史</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="mui-content">
        <div class="banner swiper-container">
            <div class="swiper-wrapper" id="wrapper">

			</div>
            <div class="swiper-pagination"></div>
        </div>

        <div class="home-nav ui-box">
            <div class="ui-flex flex-justify-sb" id="homenav">
               
            </div>
        </div>

        <div class="home-qnav ui-box">
            <div class="ui-flex flex-justify-sb" id="qnav">
				
            </div>
        </div>

        <div class="home-newgoods ui-box">
            <img class="home-imgtit" src=""  alt="" />
            <div class="list-type1 plist-puzzle" id="newgoods" >
				
            </div>
            <img class="home-imgtit" src="" alt="" />
            <div class="list-type2 ui-flex flex-justify-sb" id="newgoods2">
				
            </div>
        </div>

        <div class="home-fashion ui-box ui-border-t" id="fashion">
			
        </div>
    </div> <!--mui-content end-->
</div>
   

    <footer class="page-footer fixed-footer" id="footer">
		<ul>
			<li class="active">
				<a href="index.html">
					<img src="images/footer01.png"/>
					<p>首页</p>
				</a>
			</li>
			<li>
				<a href="assort.html">
					<img src="images/footer002.png"/>
					<p>分类</p>
				</a>
			</li>
			<li>
				<a href="shopcar.html">
					<img src="images/footer003.png"/>
					<p>购物车</p>
				</a>
			</li>
			<li>
				<a href="self.html">
					<img src="images/footer004.png"/>
					<p>个人中心</p>
				</a>
			</li>
		</ul>
	</footer>

</body>
<script src="js/jquery.min.js" type="text/javascript" charset="utf-8"></script>

<script src="js/fastclick.js"></script>

<script src="js/hmt.js" type="text/javascript" charset="utf-8"></script>
<script src="js/mui.min.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript" src="js/hmt.js" ></script>

<!--插件-->
<link rel="stylesheet" href="js/swiper/swiper.min.css">
<script src="js/swiper/swiper.jquery.min.js"></script>
<!--插件-->
<script src="js/global.js"></script>
<script >
//令返回失效
history.pushState(null, null, window.location.href)
window.onpopstate = function (event) {
	   history.go(1)
}
mui.plusReady(function() {
	//首页返回键处理
	//处理逻辑：2秒内，连续两次按返回键，则退出应用
	var first = null;
	plus.key.addEventListener('backbutton', function() {
		//首次按键，提示‘再按一次退出应用’
		if(!first) {
			first = new Date().getTime();
			mui.toast('再按一次退出应用');
			setTimeout(function() {
				first = null;
			}, 2000);
		} else {
			if(new Date().getTime() - first < 2000) {
				plus.runtime.quit();
			}
		}
	}, false);
});

$(function () {
	/* 轮播图广告 */
	mui.ajax('http://'+getIp()+':8891/rest/content/category/89',{
			data:{
				
			},
			dataType:'json',//服务器返回json格式数据
			type:'get',//HTTP请求类型
			timeout:10000,//超时时间设置为10秒；
			headers:{'Content-Type':'application/json'},	              
			success:function(response){
				//服务器返回响应，根据响应结果，
				var str = "";
				for(var i =0;i <response.data.length;i++){
					console.log(response.data[i].pic);
					str += '<div class="swiper-slide">'
					str += '<a href="'+response.data[i].url+'">'
					str += '<img class="swiper-lazy" data-src="'+response.data[i].pic+''
					str += '" alt="'+'"></a></div>';
				}
				$('#wrapper').append(str);
				load();
			},
			error:function(xhr,type,errorThrown){
				//异常处理；
				console.log(type);
			}
	});	
	/* 分类导航 */
	mui.ajax('http://'+getIp()+':8891/rest/content/category/118',{
			data:{
				
			},
			dataType:'json',//服务器返回json格式数据
			type:'get',//HTTP请求类型
			timeout:10000,//超时时间设置为10秒；
			headers:{'Content-Type':'application/json'},	              
			success:function(response){
				//服务器返回响应，根据响应结果，
				var data = response.data;
				str = '';				
				for(var i =0;i <data.length;i++){
					str+=' <div><a href="'+data[i].url+'"><img src="'+data[i].pic+'" alt="" /></a></div>';
				}
				$('#homenav').append(str);
			},
			error:function(xhr,type,errorThrown){
				//异常处理；
				console.log(type);
			}
	});	
	/* 个人导航 */
	mui.ajax('http://'+getIp()+':8891/rest/content/category/119',{
			data:{
				
			},
			dataType:'json',//服务器返回json格式数据
			type:'get',//HTTP请求类型
			timeout:10000,//超时时间设置为10秒；
			headers:{'Content-Type':'application/json'},	              
			success:function(response){
				//服务器返回响应，根据响应结果，
				var data = response.data;
				str = '';				
				for(var i =0;i <data.length;i++){
					str+=' <div><a href="'+data[i].url+'">';
					str+='<img src="'+data[i].pic+'" class="ico" />';
					str+='<span class="name">'+data[i].subTitle+'</span></a></div>';
				}
				$('#qnav').append(str);
			},
			error:function(xhr,type,errorThrown){
				//异常处理；
				console.log(type);
			}
	});	
	/* 每日新款发售 */
	mui.ajax('http://'+getIp()+':8891/rest/content/category/114',{
			data:{
				
			},
			dataType:'json',//服务器返回json格式数据
			type:'get',//HTTP请求类型
			timeout:10000,//超时时间设置为10秒；
			headers:{'Content-Type':'application/json'},	              
			success:function(response){
				//服务器返回响应，根据响应结果，
				var data = response.data;
				$('#newgoods').prev().attr('src',data[0].pic);
				str = '';
				str+='<a class="b" href="'+data[1].url+'"><img src="'+data[1].pic+'" alt="" /></a>';
				str+='<div class="s ui-flex-vt flex-justify-sb">';
				
				for(var i =2;i <data.length;i++){
					str+='<a class="box" href="'+data[i].url+'"><img src="'+data[i].pic+'" alt="" /></a>';
				}
				str+='</div>'
				$('#newgoods').append(str);
				
			},
			error:function(xhr,type,errorThrown){
				//异常处理；
				console.log(type);
			}
	});	
	/* 每日新款 */
	mui.ajax('http://'+getIp()+':8891/rest/content/category/116',{
			data:{
				
			},
			dataType:'json',//服务器返回json格式数据
			type:'get',//HTTP请求类型
			timeout:10000,//超时时间设置为10秒；
			headers:{'Content-Type':'application/json'},	              
			success:function(response){
				//服务器返回响应，根据响应结果，
				var data = response.data;
				$('#newgoods2').prev().attr('src',data[0].pic);
				str = '';
				for(var i =1;i <data.length;i++){
					str+='<a class="box" href="'+data[i].url+'">';
					str+='<img class="figure" src="'+data[i].pic+'" alt="" />';
					str+='<span class="tit">'+data[i].subTitle+'</span></a>';
				}
				$('#newgoods2').append(str);
				
			},
			error:function(xhr,type,errorThrown){
				//异常处理；
				console.log(type);
			}
	});	
/* 正在流行 */
	mui.ajax('http://'+getIp()+':8891/rest/content/category/117',{
			data:{
				
			},
			dataType:'json',//服务器返回json格式数据
			type:'get',//HTTP请求类型
			timeout:10000,//超时时间设置为10秒；
			headers:{'Content-Type':'application/json'},	              
			success:function(response){
				//服务器返回响应，根据响应结果，
				var data = response.data;
				str ='';
				str+='<img class="home-imgtit" src="'+data[0].pic+'" alt="" />';
				str+='<a href="'+data[1].url+'"><img class="db margin-b-s" src="'+data[1].pic+'" width="100%" alt="" /></a>';
				str+='<div class="fastion-plist mui-row" >';
				
				for (var i = 2; i < data.length; i++) {
					str+='    <div class="mui-col-xs-4">';
					str+='        <a class="item" href="'+data[i].url+'">';
					str+='            <img src="'+data[i].pic+'" alt="" class="figure" /><span class="tit">'+data[i].subTitle+'</span>';
					str+='        </a>';
					str+='    </div>';
				}
				
				str+='</div>';
				$('#fashion').append(str);
				
			},
			error:function(xhr,type,errorThrown){
				//异常处理；
				console.log(type);
			}
	});	
	//历史搜索
	var sqListCookie = localStorage.getItem('sqHistory');
	console.log(sqListCookie);
		if(sqListCookie!=null){
			var sqlist= sqListCookie.split(',');
			console.log(sqlist);
			var dic = {};
			for (var i = sqlist.length; i--; ){
				dic[sqlist[i]]=sqlist[i];
			}
			var r = [];
			for (var v in dic) {
			r.push(dic[v]);
			}
			console.log(r);
			for (var i in r) {
				$('#tags2').append('<a class="tag" href="searchlist.html?catename='+r[i]+'">'+r[i]+'</a>');
			}
		}
		
	//清除历史搜索
	$('#clearsq').click(function(){
		localStorage.removeItem('sqHistory');
		$('#tags2').html('')
	})
	$("#search").click(function(){
		var sq = $('[name=sq]').val();
		console.log(sq);
		var sqListCookie = localStorage.getItem('sqHistory');
		if(sqListCookie==null){
			var sqList = [];
			sqList.push(sq);
			localStorage.setItem('sqHistory',sqList);
			location.href= 'searchlist.html?catename='+sq;
		}else{
			var sqList = [];
			sqList.push(sqListCookie);
			sqList.push(sq);
			localStorage.setItem('sqHistory',sqList);
			location.href= 'searchlist.html?catename='+sq;
		}
		
	})
	
	
	
});


function load(){
	var banner = new Swiper('.banner',{
		autoplay: 5000,
		pagination : '.swiper-pagination',
		paginationClickable: true,
		lazyLoading : true,
		loop:true
	});
	
	 mui('.pop-schwrap .sch-input').input();
	var deceleration = mui.os.ios?0.003:0.0009;
	 mui('.pop-schwrap .scroll-wrap').scroll({
			bounce: true,
			indicators: true,
			deceleration:deceleration
	});
	$('.top-sch-box .fdj,.top-sch-box .sch-txt,.pop-schwrap .btn-back').on('click',function () {
		$('html,body').toggleClass('holding');
		$('.pop-schwrap').toggleClass('on');
		if($('.pop-schwrap').hasClass('on')) {;
			$('.pop-schwrap .sch-input').focus();
		}
	});	
}

</script>
</html>